define("local_tagmanager/managecollection",["jquery","core/str","core/notification"],(function($,Str,Notification){function initExportSelected(tc){const $combine=$("#tag-management-combine");if(!$combine.length)return;const $form=$combine.closest("form");if(!$form.length)return;if($form.find(".local-tagmanager-exportselected").length)return;const $btn=$("<button/>",{type:"button",class:"btn btn-secondary local-tagmanager-exportselected",text:"Export selected"});$btn.insertAfter($combine);let noneMsg="No tags selected";Str.get_strings([{key:"exportselected",component:"local_tagmanager"},{key:"exportselectednone",component:"local_tagmanager"}]).then((function(strings){$btn.text(strings[0]),noneMsg=strings[1]})),$btn.on("click",(function(e){e.preventDefault();const ids=function(){const ids=$('[data-region="reportbuilder-table"] input[name="report-select-row[]"][data-toggle="slave"]:checked').map((function(){return($(this).val()||"").toString().trim()})).get().filter((v=>/^\d+$/.test(v)));return[...new Set(ids)]}();if(!ids.length)return void Notification.addNotification({message:noneMsg,type:"info"});const url=M.cfg.wwwroot+"/local/tagmanager/export.php?tc="+encodeURIComponent(tc)+"&tagids="+encodeURIComponent(ids.join(","))+"&sesskey="+encodeURIComponent(M.cfg.sesskey);window.location.href=url}))}return{init:function(tc){$((function(){tc&&(initExportSelected(tc),function(tc){const $row=$(".d-flex.justify-content-between.mb-2").first();if(!$row.length)return;const $addStandard=$row.find('button[data-action="addstandardtag"]').first();if(!$addStandard.length)return;if($row.find(".local-tagmanager-importstandard").length)return;let $right=$row.find(".local-tagmanager-header-actions");$right.length||($right=$("<div/>",{class:"d-flex align-items-center gap-2 local-tagmanager-header-actions"}),$addStandard.detach().appendTo($right),$row.append($right),$row.addClass("align-items-center"));const $btn=$("<button/>",{type:"button",class:"btn btn-primary local-tagmanager-importstandard",html:'<i class="icon fa fa-plus fa-fw" aria-hidden="true"></i> Import standard tags'});$right.append($btn),$btn.on("click",(function(){window.location.href=M.cfg.wwwroot+"/local/tagmanager/import.php?tc="+encodeURIComponent(tc)}))}(tc))}))}}}));

//# sourceMappingURL=managecollection.min.js.map